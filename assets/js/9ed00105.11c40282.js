"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4],{9613:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var i=t(9496);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),c=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return i.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=a,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||r;return t?i.createElement(f,o(o({ref:n},u),{},{components:t})):i.createElement(f,o({ref:n},u))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<r;c++)o[c]=t[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3891:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=t(4250),a=(t(9496),t(9613));const r={},o="Configuration",l={unversionedId:"configuration",id:"configuration",title:"Configuration",description:"There are three ways to configure mocktomata.",source:"@site/docs/configuration.md",sourceDirName:".",slug:"/configuration",permalink:"/configuration",draft:!1,editUrl:"https://github.com/mocktomata/website/docs/configuration.md",tags:[],version:"current",frontMatter:{}},s={},c=[{value:"Configuration File",id:"configuration-file",level:2},{value:"Using <code>config()</code>",id:"using-config",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Tips and Tricks",id:"tips-and-tricks",level:2},{value:"Define plugins in configuration file",id:"define-plugins-in-configuration-file",level:3},{value:"Change mode using <code>config()</code> function",id:"change-mode-using-config-function",level:3},{value:"Use Environment Variables in CI",id:"use-environment-variables-in-ci",level:3},{value:"Acceptance Tests",id:"acceptance-tests",level:3},{value:"Refresh Records",id:"refresh-records",level:3},{value:"Detect Stale Records",id:"detect-stale-records",level:3}],u={toc:c};function p(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"There are three ways to configure ",(0,a.kt)("inlineCode",{parentName:"p"},"mocktomata"),"."),(0,a.kt)("p",null,"Each way has its own application.\nAlso, since ",(0,a.kt)("inlineCode",{parentName:"p"},"mocktomata")," can run in multiple environments,\nthe configuration may vary depending on the environment.\n(the variation will be added in the future)"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#configuration"},"Configuration"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#configuration-file"},"Configuration File")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#using-config"},"Using ",(0,a.kt)("inlineCode",{parentName:"a"},"config()"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#environment-variables"},"Environment Variables")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#tips-and-tricks"},"Tips and Tricks"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#define-plugins-in-configuration-file"},"Define plugins in configuration file")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#change-mode-using-config-function"},"Change mode using ",(0,a.kt)("inlineCode",{parentName:"a"},"config()")," function")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#use-environment-variables-in-ci"},"Use Environment Variables in CI")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#acceptance-tests"},"Acceptance Tests")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#refresh-records"},"Refresh Records")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#detect-stale-records"},"Detect Stale Records"))))))),(0,a.kt)("h2",{id:"configuration-file"},"Configuration File"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"mocktomata")," will look for ",(0,a.kt)("inlineCode",{parentName:"p"},".mocktomata.js"),", ",(0,a.kt)("inlineCode",{parentName:"p"},".mocktomata.json"),", or the ",(0,a.kt)("inlineCode",{parentName:"p"},"mocktomata")," section inside ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json"),"."),(0,a.kt)("p",null,"Only one of them should be used at a time.\nIf more than one configuration are found,\nit will throw a ",(0,a.kt)("inlineCode",{parentName:"p"},"AmbiguousConfig")," error."),(0,a.kt)("p",null,"Using ",(0,a.kt)("inlineCode",{parentName:"p"},".mocktomata.json")," as an example,\nhere is what can be configured and their default values:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // Overrides which mode `mockto()` runs in.\n  // By default `mockto()` runs in auto mode.\n  "overrideMode": "<live | save | simulate>",\n  // Filter which `mockto()` mode to override by file path.\n  "filePathFilter": "<regex>",\n  // Filter which `mockto()` mode to override by spec name.\n  "specNameFilter": "<regex>",\n  // A list of plugins to use.\n  "plugins": ["plugin-a"]\n}\n')),(0,a.kt)("h2",{id:"using-config"},"Using ",(0,a.kt)("inlineCode",{parentName:"h2"},"config()")),(0,a.kt)("p",null,"Configuration can also be overridden in the runtime using the ",(0,a.kt)("inlineCode",{parentName:"p"},"config()")," function.\nThis is useful when the configuration is stored in different means (e.g. database or remote service),\nor used during test startup or test runner plugins (e.g. jest watch plugins) so that the test process do not need to be restarted and do not need to manually change the configuration files."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import { config } from \'mocktomata\'\n\nconfig({\n  overrideMode: "<live | save | simulate>",\n  filePathFilter: "<regex>",\n  specNameFilter: "<regex>",\n  plugins: ["plugin-a"],\n  // currently only debug level is available\n  logLevel: \'debug\'\n})\n')),(0,a.kt)("h2",{id:"environment-variables"},"Environment Variables"),(0,a.kt)("p",null,"Specific configuration can be overridden using environment variables.\nThis allows different CI jobs to run ",(0,a.kt)("inlineCode",{parentName:"p"},"mocktomata")," with different configuration."),(0,a.kt)("p",null,"The names are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MOCKTOMATA_MODE")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MOCKTOMATA_FILE_FILTER")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MOCKTOMATA_SPEC_FILTER")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MOCKTOMATA_LOG"))),(0,a.kt)("h2",{id:"tips-and-tricks"},"Tips and Tricks"),(0,a.kt)("p",null,"Each configuration mechanism provided is designed for a specific purpose.\nBy using these mechanisms with their intended usage,\nit would be easier for you to configure ",(0,a.kt)("a",{parentName:"p",href:"../README.md"},(0,a.kt)("inlineCode",{parentName:"a"},"mocktomata"))," to your specific needs."),(0,a.kt)("h3",{id:"define-plugins-in-configuration-file"},"Define plugins in configuration file"),(0,a.kt)("p",null,"This is kind of a no-brainer.\nIf your library/application supports multiple environments and requires different plugins,\nuse ",(0,a.kt)("inlineCode",{parentName:"p"},".mocktomata.js")," so that you can use different plugins if needed."),(0,a.kt)("h3",{id:"change-mode-using-config-function"},"Change mode using ",(0,a.kt)("inlineCode",{parentName:"h3"},"config()")," function"),(0,a.kt)("p",null,"While you can do the same with environment variable,\ncalling ",(0,a.kt)("inlineCode",{parentName:"p"},"config()")," in a test setup file is much easier and faster."),(0,a.kt)("p",null,"Especially when you try to flip tests quickly."),(0,a.kt)("h3",{id:"use-environment-variables-in-ci"},"Use Environment Variables in CI"),(0,a.kt)("p",null,"Environment variable based configuration is designed for CI usage."),(0,a.kt)("h3",{id:"acceptance-tests"},"Acceptance Tests"),(0,a.kt)("p",null,"Turn your tests into acceptance tests by running tests with ",(0,a.kt)("inlineCode",{parentName:"p"},"overrideMode = 'live'"),"."),(0,a.kt)("h3",{id:"refresh-records"},"Refresh Records"),(0,a.kt)("p",null,"You can easily refresh all records by running tests with ",(0,a.kt)("inlineCode",{parentName:"p"},"overrideMode = 'save'"),"."),(0,a.kt)("h3",{id:"detect-stale-records"},"Detect Stale Records"),(0,a.kt)("p",null,"(To be implemented)"))}p.isMDXComponent=!0}}]);