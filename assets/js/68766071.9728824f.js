"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[614],{9613:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>k});var a=n(9496);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),m=c(n),k=o,d=m["".concat(s,".").concat(k)]||m[k]||u[k]||r;return n?a.createElement(d,i(i({ref:t},l),{},{components:n})):a.createElement(d,i({ref:t},l))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8619:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>p,toc:()=>c});var a=n(4250),o=(n(9496),n(9613));const r={hide_title:!0},i=void 0,p={unversionedId:"incubator",id:"incubator",title:"incubator",description:"incubator",source:"@site/docs/incubator.md",sourceDirName:".",slug:"/incubator",permalink:"/website/incubator",draft:!1,editUrl:"https://github.com/mocktomata/website/blob/main/docs/incubator.md",tags:[],version:"current",frontMatter:{hide_title:!0},sidebar:"mocktomata",previous:{title:"zucchini",permalink:"/website/zucchini"},next:{title:"Spec",permalink:"/website/spec"}},s={},c=[{value:"<code>incubator</code>",id:"incubator",level:2},{value:"<code>config()</code>",id:"config",level:2},{value:"<code>incubator()</code>",id:"incubator-1",level:2},{value:"<code>incubator.sequence()</code>",id:"incubatorsequence",level:2}],l={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"incubator"},(0,o.kt)("inlineCode",{parentName:"h2"},"incubator")),(0,o.kt)("p",null,"Greetings, this is ",(0,o.kt)("inlineCode",{parentName:"p"},"incubator"),"."),(0,o.kt)("p",null,"In normal cases, you won't be utilizing myself."),(0,o.kt)("p",null,"You will be using either ",(0,o.kt)("a",{parentName:"p",href:"/website/mockto"},(0,o.kt)("inlineCode",{parentName:"a"},"mockto")),", ",(0,o.kt)("a",{parentName:"p",href:"/website/komondor"},(0,o.kt)("inlineCode",{parentName:"a"},"komondor")),", or ",(0,o.kt)("a",{parentName:"p",href:"/website/zucchini"},"zucchini"),"."),(0,o.kt)("p",null,"However, you may need me if you encounter a situation where ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mocktomata/mocktomata/blob/master/packages/mocktomata"},"mocktomata")," is unable to work with your code."),(0,o.kt)("p",null,"Because, I am specialized in developing ",(0,o.kt)("a",{parentName:"p",href:"/website/plugin"},"plugins"),"."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/mocktomata/mocktomata/blob/master/packages/mocktomata"},"mocktomata")," supports plugins to extends its capability.\nIn fact, its ability to handle JavaScript types such as ",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"array"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"function"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"object"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"promise")," etc.,\nare all implemented by plugins."),(0,o.kt)("p",null,"While ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mocktomata/mocktomata/blob/master/packages/mocktomata"},"mocktomata")," tries to handle most of the cases out of the box,\nthere are limits to that because what it tries to solve is really a NP problem."),(0,o.kt)("p",null,"So when you encounter a case that ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/mocktomata/mocktomata/blob/master/packages/mocktomata"},"mocktomata")," doesn't work,\nyou will need to find a plugin, or create one."),(0,o.kt)("p",null,"To understand how to create a plugin, you can refer to the ",(0,o.kt)("a",{parentName:"p",href:"/website/plugin"},"plugin documentation"),".\nHere, I'm going to show you how to utilize me to implement and test your plugin."),(0,o.kt)("h2",{id:"config"},(0,o.kt)("inlineCode",{parentName:"h2"},"config()")),(0,o.kt)("p",null,"The first thing you need to do is to ask me to load your plugin by calling ",(0,o.kt)("inlineCode",{parentName:"p"},"config()"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { incubator } from 'mocktomata'\nimport { activate } from '.'\n\nincubator.config({\n  plugins: [\n    ['your-plugin', activate], // or 'your-plugin'\n    'other-plugin'\n  ]\n})\n")),(0,o.kt)("p",null,"The signature of ",(0,o.kt)("inlineCode",{parentName:"p"},"config()")," is:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("inlineCode",{parentName:"p"},"config({ plugins: Array<name: string | [name: string, activate: (context) => void]> })"))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"plugins")," property is an array accepting either ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"[name, activate]"),".\nWhich one to use depends on where are you writing your tests."),(0,o.kt)("p",null,"If you pass in just ",(0,o.kt)("inlineCode",{parentName:"p"},"name"),", it will try to load the plugin package."),(0,o.kt)("p",null,"Given that you are likely writing your plugin and writing your tests together,\nmost likely you will use the second one and pass in your plugin's ",(0,o.kt)("a",{parentName:"p",href:"/website/plugin#activate"},(0,o.kt)("inlineCode",{parentName:"a"},"activate()"))," function directly."),(0,o.kt)("p",null,"As shown in the example above, you can load other plugins to create a specific test environment."),(0,o.kt)("p",null,"Note that the general configuration mechanism does not affect me."),(0,o.kt)("p",null,"Once you have your plugin loaded, you can start writing tests."),(0,o.kt)("h2",{id:"incubator-1"},(0,o.kt)("inlineCode",{parentName:"h2"},"incubator()")),(0,o.kt)("p",null,"The primary way I work is quite similar to ",(0,o.kt)("a",{parentName:"p",href:"/website/mockto"},(0,o.kt)("inlineCode",{parentName:"a"},"mockto")),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { incubator } from 'mocktomata'\n\nincubator('...', (specName, spec, reporter) => {\n  test(specName, async () => {\n    const s = await spec({ a: 1 })\n    // ...\n    await spec.done()\n  })\n})\n")),(0,o.kt)("p",null,"The difference is, instead of running the test in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"auto"))," mode and save the ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specrecord"},(0,o.kt)("inlineCode",{parentName:"a"},"SpecRecord"))," as needed,\nI run the test twice: once in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"save"))," mode, and once in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"simulate"))," mode."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specrecord"},(0,o.kt)("inlineCode",{parentName:"a"},"SpecRecord"))," is also not saved to a file, but is kept in memory."),(0,o.kt)("p",null,"The signature is:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("inlineCode",{parentName:"p"},"incubator(specName, specOptions?, handler: (specName, spec, reporter) => void)"))),(0,o.kt)("p",null,"Where ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#uniqueness-of-specname"},(0,o.kt)("inlineCode",{parentName:"a"},"specName"))," must be unique within one test file,\nand ",(0,o.kt)("inlineCode",{parentName:"p"},"specOptions")," is a ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#spec"},(0,o.kt)("inlineCode",{parentName:"a"},"Spec.options")),"."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#spec"},(0,o.kt)("inlineCode",{parentName:"a"},"spec()"))," is a function as well as an object holder other functions and properties:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"spec.mode"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/website/spec#done"},(0,o.kt)("inlineCode",{parentName:"a"},"spec.done()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/website/spec#maskvalue"},(0,o.kt)("inlineCode",{parentName:"a"},"spec.maskValue()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/website/spec#ignoremismatch"},(0,o.kt)("inlineCode",{parentName:"a"},"spec.ignoreMismatch()")))),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/website/spec#reporter"},(0,o.kt)("inlineCode",{parentName:"a"},"reporter"))," is a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/unional/standard-log/blob/main/packages/log/ts/memory.ts#L7"},(0,o.kt)("inlineCode",{parentName:"a"},"MemoryLogReporter")),"."),(0,o.kt)("p",null,"So what I do is running the test twice so that it goes through the whole life cycle of your plugin,\nto make sure it is working as expected."),(0,o.kt)("p",null,"I also support ",(0,o.kt)("inlineCode",{parentName:"p"},"incubator.save()")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"incubator.simulate()")," to run the test only in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"save"))," or in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"simulate"))," mode."),(0,o.kt)("p",null,"They are useful when you want to focus on one part of the lifecycle."),(0,o.kt)("p",null,"(You use ",(0,o.kt)("inlineCode",{parentName:"p"},"incubator.simulate()")," for testing error cases, as there won't be any ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specrecord"},(0,o.kt)("inlineCode",{parentName:"a"},"SpecRecord"))," to simulate against)."),(0,o.kt)("h2",{id:"incubatorsequence"},(0,o.kt)("inlineCode",{parentName:"h2"},"incubator.sequence()")),(0,o.kt)("p",null,"Beside ",(0,o.kt)("a",{parentName:"p",href:"#incubator"},(0,o.kt)("inlineCode",{parentName:"a"},"incubator()")),",\nI support this ",(0,o.kt)("a",{parentName:"p",href:"#incubatorsequence"},(0,o.kt)("inlineCode",{parentName:"a"},"incubator.sequence()"))," call which allows you to run the ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#spec"},"Spec")," in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"save"))," and in ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#specmode"},(0,o.kt)("inlineCode",{parentName:"a"},"simulate"))," mode,\nin the way you want it to:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { incubator } from 'mocktomata'\n\nincubator.sequence('...', (specName, { save, simulate }, reporter) => {\n  test(specName, async () => {\n    {\n      const s = await save(subject)\n      // ...\n      await save.done()\n    }\n    {\n      const s = await simulate(subject)\n      // ...\n      await simulate.done()\n    }\n  })\n})\n")),(0,o.kt)("p",null,"You can use this to test some corner cases, such as error cases, or ",(0,o.kt)("a",{parentName:"p",href:"/website/spec#maskvalue"},"masking"),"."))}u.isMDXComponent=!0}}]);